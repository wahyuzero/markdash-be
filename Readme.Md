# MarkDash Backend ğŸ“Š

Backend API untuk **MarkDash** - sistem dashboard interaktif berbasis Markdown dengan fitur checklist, log aktivitas, dan notifikasi.

## âœ¨ Fitur Utama

- âœ… **Authentication** - Register, login dengan JWT (24h expiry)
- ğŸ“‹ **Board Management** - CRUD dashboard dengan markdown + metadata
- ğŸ•’ **Activity Logs** - Track checklist completion dan aktivitas
- ğŸ”” **Notifications** - Reminder dan notifikasi berbasis waktu
- ğŸ”’ **Security** - Password hashing (bcrypt), JWT middleware
- ğŸŒ **Public Boards** - Share dashboard secara publik
- ğŸ’¾ **Deno KV** - Database NoSQL built-in Deno

## ğŸš€ Quick Start

### Prerequisites
- [Deno](https://deno.land/) v2.5+

### Installation

```bash
# Clone repository
git clone https://github.com/wahyuzero/markdash-be
cd markdash-be

# Run server
deno task start

# Or dengan watch mode (auto-reload)
deno task dev
```

Server akan berjalan di `http://localhost:8000`

### Environment Variables

Buat file `.env` (opsional):

```env
PORT=8000
JWT_SECRET=your-super-secret-key-change-this
```

## ğŸ“ Struktur Folder

```
markdash-backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                 # Entry point server
â”‚   â”œâ”€â”€ types.ts                # Type definitions
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ authMiddleware.ts   # JWT validation
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.ts             # Auth endpoints
â”‚   â”‚   â”œâ”€â”€ boards.ts           # Board CRUD
â”‚   â”‚   â”œâ”€â”€ logs.ts             # Activity logs
â”‚   â”‚   â””â”€â”€ notify.ts           # Notifications
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ kv.ts               # Deno KV operations
â”‚       â”œâ”€â”€ crypto.ts           # Password & JWT utils
â”‚       â””â”€â”€ response.ts         # Response helpers
â”œâ”€â”€ deno.json                   # Deno configuration
â””â”€â”€ README.md
```

## ğŸ› ï¸ Tech Stack

- **Runtime:** Deno 2.5
- **Framework:** Oak (Router + Middleware)
- **Database:** Deno KV (Built-in NoSQL)
- **Auth:** JWT + bcrypt
- **Deployment:** Deno Deploy ready


### Quick API Overview

#### Authentication
```bash
POST /api/register       # Register user baru
POST /api/login          # Login & dapat JWT token
GET  /api/me             # Info user saat ini
POST /api/logout         # Logout
```

#### Boards
```bash
GET    /api/boards          # List semua board
GET    /api/boards/:id      # Detail board
POST   /api/boards          # Buat board baru
PUT    /api/boards/:id      # Update board
DELETE /api/boards/:id      # Hapus board
GET    /api/public/:boardId # Akses public board (no auth)
```

#### Logs
```bash
GET    /api/logs/:boardId           # List logs by board
GET    /api/logs/:boardId/:date     # Log tanggal spesifik
POST   /api/logs                    # Buat/update log
DELETE /api/logs/:id                # Hapus log
```

#### Notifications
```bash
GET    /api/notify/:boardId         # List notifikasi aktif
POST   /api/notify                  # Buat notifikasi
PATCH  /api/notify/:id/dismiss      # Dismiss notifikasi
DELETE /api/notify/:id              # Hapus notifikasi
```

## ğŸ’» Frontend Integration

### Contoh Login

```javascript
const response = await fetch('http://localhost:8000/api/login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ username: 'john', password: 'pass123' })
});

const { token, user } = await response.json();
localStorage.setItem('authToken', token);
```

### Contoh Fetch Boards

```javascript
const token = localStorage.getItem('authToken');

const boards = await fetch('http://localhost:8000/api/boards', {
  headers: { 'Authorization': `Bearer ${token}` }
}).then(r => r.json());
```

### Contoh Log Checklist

```javascript
await fetch('http://localhost:8000/api/logs', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
  },
  body: JSON.stringify({
    boardId: 'abc123',
    actions: [
      { type: 'check', task: 'Morning standup', time: new Date().toISOString() }
    ]
  })
});
```

## ğŸ”‘ Deno KV Key Patterns

```
user:${userId}                    # User data
user_by_username:${username}      # Username lookup
board:${userId}:${boardId}        # Board data
log:${boardId}:${date}            # Daily log (YYYY-MM-DD)
notif:${boardId}:${notifId}       # Notification data
```

## ğŸ” Security Features

- âœ… Password hashing dengan bcrypt
- âœ… JWT dengan expiry 24 jam
- âœ… Protected routes dengan middleware
- âœ… User-specific data isolation
- âœ… Public/private board visibility

## ğŸš¢ Deployment

### Deploy ke Deno Deploy

1. Install Deno Deploy CLI:
```bash
deno install -Arf jsr:@deno/deployctl
```

2. Deploy project:
```bash
deployctl deploy --project=markdash src/main.ts
```

3. Set environment variables di Deno Deploy dashboard:
   - `JWT_SECRET` = your-secret-key


## ğŸ§ª Testing

```bash
# Test endpoints dengan curl
curl http://localhost:8000/api

# Register user
curl -X POST http://localhost:8000/api/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","password":"test123"}'

# Login
curl -X POST http://localhost:8000/api/login \
  -H "Content-Type: application/json" \
  -d '{"username":"test","password":"test123"}'
```


## ğŸ“ License

MIT License
